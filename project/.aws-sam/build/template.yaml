AWSTemplateFormatVersion: '2010-09-09'
Transform: AWS::Serverless-2016-10-31
Description: "Stack Grava\xE7\xE3o de dados Ass\xEDncrona"
Parameters:
  TableName:
    Type: String
    Default: DataTable
  RoleArn:
    Type: String
    Description: ARN of the IAM role for Lambda functions
  BucketName:
    Type: String
    Default: data-bucket-370819
Globals:
  Function:
    Timeout: 5
    MemorySize: 128
    Runtime: provided.al2023
    Architectures:
    - x86_64
Resources:
  DataBucket:
    Type: AWS::S3::Bucket
    Properties:
      BucketName:
        Ref: BucketName
  Transformer:
    Type: AWS::Serverless::Function
    Metadata:
      BuildMethod: go1.x
      SamResourceId: Transformer
    Properties:
      CodeUri: Transformer
      Handler: bootstrap
      Role:
        Ref: RoleArn
      Events:
        S3Event:
          Type: S3
          Properties:
            Bucket:
              Ref: DataBucket
            Events: s3:ObjectCreated:*
